"use strict";(self.webpackChunkfreshCart=self.webpackChunkfreshCart||[]).push([[290],{779:(g,m,s)=>{s.d(m,{N:()=>p});var d=s(5619),_=s(4769),t=s(9862),C=s(2425);let p=(()=>{class n{constructor(o,c){this._HttpClient=o,this.toastr=c,this.baseUrl="https://ecommerce.routemisr.com",this.numberofcartItems=new d.X(0)}addToCart(o){return this._HttpClient.post(`${this.baseUrl}/api/v1/cart`,{productId:o})}getLoggedUserCart(){return this._HttpClient.get(`${this.baseUrl}/api/v1/cart`)}removeItemFromCart(o){return this._HttpClient.delete(`${this.baseUrl}/api/v1/cart/${o}`)}removeCart(){return this._HttpClient.delete(`${this.baseUrl}/api/v1/cart`)}updateCartProductQuantity(o,c){return this._HttpClient.put(`${this.baseUrl}/api/v1/cart/${o}`,{count:c})}static#t=this.\u0275fac=function(c){return new(c||n)(_.LFG(t.eN),_.LFG(C._W))};static#r=this.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()},5290:(g,m,s)=>{s.r(m),s.d(m,{CartComponent:()=>c});var d=s(6814),_=s(1120),t=s(4769),C=s(779);function p(i,h){if(1&i&&(t.TgZ(0,"div",3)(1,"p",4),t._uU(2),t.qZA()()),2&i){const r=t.oxw();t.xp6(2),t.Oqu(r.errorMessage)}}function n(i,h){if(1&i){const r=t.EpF();t.TgZ(0,"div",12)(1,"div",13)(2,"div"),t._UZ(3,"img",14),t.qZA()(),t.TgZ(4,"div",15)(5,"div",16)(6,"div")(7,"h2",8),t._uU(8),t.qZA(),t.TgZ(9,"span",17),t._uU(10),t.qZA(),t.TgZ(11,"span",18),t.NdJ("click",function(){const u=t.CHM(r).$implicit,l=t.oxw(2);return t.KtG(l.removeItemFromCart(u.product.id))}),t._uU(12,"Remove Product "),t._UZ(13,"i",19),t.qZA()(),t.TgZ(14,"div")(15,"button",20),t.NdJ("click",function(){const u=t.CHM(r).$implicit,l=t.oxw(2);return t.KtG(l.updateCartProductQuantity(u.product.id,u.count+1))}),t._uU(16,"+"),t.qZA(),t.TgZ(17,"span",21),t._uU(18),t.qZA(),t.TgZ(19,"button",22),t.NdJ("click",function(){const u=t.CHM(r).$implicit,l=t.oxw(2);return t.KtG(l.updateCartProductQuantity(u.product.id,u.count-1))}),t._uU(20,"-"),t.qZA()()()()()}if(2&i){const r=h.$implicit;t.xp6(3),t.Q6J("src",r.product.imageCover,t.LSH),t.xp6(5),t.Oqu(r.product.title.split(" ").splice(0,4).join(" ")),t.xp6(2),t.hij("",r.price,"EGP"),t.xp6(5),t.Q6J("disabled",r.count+1===r.product.quantity),t.xp6(3),t.Oqu(r.count)}}const f=function(i){return["/shippingAddress",i]};function o(i,h){if(1&i){const r=t.EpF();t.TgZ(0,"div")(1,"div",5)(2,"button",6),t._uU(3,"CheckOut"),t.qZA()(),t.TgZ(4,"div",7)(5,"p",8),t._uU(6,"numOfCartItems:"),t.TgZ(7,"span",9),t._uU(8),t.qZA()(),t.TgZ(9,"p",8),t._uU(10,"TotalPrice:"),t.TgZ(11,"span",9),t._uU(12),t.qZA()()(),t.YNc(13,n,21,5,"div",10),t.TgZ(14,"button",11),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.ClearCart())}),t._uU(15,"Clear Cart"),t.qZA()()}if(2&i){const r=t.oxw();t.xp6(2),t.Q6J("routerLink",t.VKq(4,f,r.cartId)),t.xp6(6),t.hij("",r.numOfCartItems," "),t.xp6(4),t.hij(" ",r.totalCartPrice," "),t.xp6(1),t.Q6J("ngForOf",r.productList)}}let c=(()=>{class i{constructor(r){this._CartService=r,this.cartId="",this.isloading=!0,this.errorMessage="",this.numOfCartItems=0,this.totalCartPrice=0,this.productList=[]}ngOnInit(){this.getallcarts()}getallcarts(){this._CartService.getLoggedUserCart().subscribe({next:r=>{this.isloading=!1,this.numOfCartItems=r.numOfCartItems,this.totalCartPrice=r.data.totalCartPrice,this.productList=r.data.products,this.cartId=r.data._id},error:r=>{this.isloading=!1,this.errorMessage="Your Cart is Empty"}})}removeItemFromCart(r){this.isloading=!0,this._CartService.removeItemFromCart(r).subscribe({next:e=>{this.isloading=!1,this.numOfCartItems=e.numOfCartItems,this.totalCartPrice=e.data.totalCartPrice,this.productList=e.data.products,this._CartService.numberofcartItems.next(e.numOfCartItems)},error:e=>{this.isloading=!1}})}updateCartProductQuantity(r,e){this._CartService.updateCartProductQuantity(r,e).subscribe({next:a=>{0==e&&this.removeItemFromCart(r),this.numOfCartItems=a.numOfCartItems,this.totalCartPrice=a.data.totalCartPrice,this.productList=a.data.products},error:a=>{console.log(a)}})}ClearCart(){this.isloading=!0,this._CartService.removeCart().subscribe({next:r=>{this.isloading=!1,this.numOfCartItems=0,this.totalCartPrice=0,this.productList=[],this.errorMessage="No Items found in this cart",this._CartService.numberofcartItems.next(0)},error:r=>{this.isloading=!1}})}static#t=this.\u0275fac=function(e){return new(e||i)(t.Y36(C.N))};static#r=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-cart"]],standalone:!0,features:[t.jDz],decls:5,vars:2,consts:[[1,"fw-bold","m-4"],["class","alert alert-danger text-white mt-4",4,"ngIf"],[4,"ngIf"],[1,"alert","alert-danger","text-white","mt-4"],[1,"text-center"],[1,"mt-4","p-2","d-flex","justify-content-between"],[1,"btn","bg-main","text-white","ms-auto","mt-3",3,"routerLink"],[1,"d-flex","justify-content-between","align-items-center","mt-4","mb-3"],[1,"fw-bold"],[1,"text-main"],["class","row shadow-sm mt-3 p-4",4,"ngFor","ngForOf"],[1,"btn","btn-outline-danger","mx-auto","d-block","mt-3",3,"click"],[1,"row","shadow-sm","mt-3","p-4"],[1,"col-md-2"],["alt","productimg",1,"w-100",3,"src"],[1,"col-md-10"],[1,"d-flex","justify-content-between","mt-4"],[1,"d-block","mt-3","mb-3","fw-bold","text-main"],[1,"text-danger","cursor-pointer",3,"click"],[1,"fa","fa-trash"],[1,"btn","bg-main","text-white",3,"disabled","click"],[1,"p-2"],[1,"btn","bg-main","text-white",3,"click"]],template:function(e,a){1&e&&(t.TgZ(0,"section")(1,"h2",0),t._uU(2,"Cart Shop"),t.qZA(),t.YNc(3,p,3,1,"div",1),t.YNc(4,o,16,6,"div",2),t.qZA()),2&e&&(t.xp6(3),t.Q6J("ngIf",a.errorMessage&&0===a.productList.length),t.xp6(1),t.Q6J("ngIf",!a.errorMessage&&a.productList.length>0))},dependencies:[d.ez,d.sg,d.O5,_.rH]})}return i})()}}]);